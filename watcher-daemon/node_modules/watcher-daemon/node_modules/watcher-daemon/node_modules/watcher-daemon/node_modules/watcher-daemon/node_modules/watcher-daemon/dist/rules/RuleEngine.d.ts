import { Rule, RuleMatch } from './types';
import { FileEvent } from '../watcher/types';
import { RuleStore } from './RuleStore';
import { SecurityValidator } from '../utils/security';
interface EngineStats {
    eventsObserved: number;
    rulesEvaluated: number;
    matches: number;
}
export declare class RuleEngine {
    private ruleStore;
    private securityValidator;
    private stats;
    private recentMatches;
    private recentMatchLimit;
    private thresholdWindows;
    private watchDir;
    constructor(ruleStore: RuleStore, watchDir: string, recentMatchLimit?: number, securityValidator?: SecurityValidator);
    init(): Promise<void>;
    evaluateEvent(event: FileEvent): Promise<RuleMatch[]>;
    private evaluateRule;
    private matchesFilter;
    private describeFilter;
    private recordMatch;
    addRule(rule: {
        name: string;
        description: string;
        condition: string;
        compiled: import('../llm/types').CompiledRule;
        source: 'llm' | 'manual';
    }): Promise<Rule>;
    getAllRules(): Promise<Rule[]>;
    getRule(id: string): Promise<Rule | null>;
    updateRule(id: string, updates: Partial<Rule>): Promise<boolean>;
    deleteRule(id: string): Promise<boolean>;
    getStats(): EngineStats;
    getRecentMatches(): RuleMatch[];
}
export {};
//# sourceMappingURL=RuleEngine.d.ts.map